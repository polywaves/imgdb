services:
  i2v:
    hostname: i2v
    image: polywaves/i2v
    restart: always
    environment:
      - MODE=production
      - TZ=Europe/Moscow
      - ENABLE_CUDA=1
      - CUDA_VISIBLE_DEVICES=0
    deploy:
      mode: replicated
      replicas: 10
      resources:
        reservations:
          generic_resources:
            - discrete_resource_spec:
                kind: NVIDIA-GPU
                value: 0
          devices:
            - driver: nvidia
              count: 1
              capabilities: ["compute"]

networks:
  services:
    external: true